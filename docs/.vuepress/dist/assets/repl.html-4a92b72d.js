import{d as b,r as v,_ as w,b as x,o as u,c as h,e as a,f as p,F as y,g,n as H,t as I,h as S,w as T,v as k,i as m,j as z,k as _}from"./app-fddc0052.js";const A={0:"ansi-reset",1:"ansi-bright",2:"ansi-dim",4:"ansi-underscore",5:"ansi-blink",7:"ansi-reverse",8:"ansi-hidden",30:"ansi-black",31:"ansi-red",32:"ansi-green",33:"ansi-yellow",34:"ansi-blue",35:"ansi-magenta",36:"ansi-cyan",37:"ansi-white",40:"ansi-onblack",41:"ansi-onred",42:"ansi-ongreen",43:"ansi-onyellow",44:"ansi-onblue",45:"ansi-onmagenta",46:"ansi-oncyan",47:"ansi-onwhite",90:"ansi-bright ansi-black",91:"ansi-bright ansi-red",92:"ansi-bright ansi-green",93:"ansi-bright ansi-yellow",94:"ansi-bright ansi-blue",95:"ansi-bright ansi-magenta",96:"ansi-bright ansi-cyan",97:"ansi-bright ansi-white"};let l=v([]);const C=b({data:()=>({wasmImports:null,ctx:null,stdin:null,replHistory:[],historyIndex:0}),computed:{stdout:function(){return l}},methods:{run(e){var t;if(!e.shiftKey&&((t=this.stdin)==null?void 0:t.length)>0){const n=document.querySelector("#stdin");(this.replHistory.length==0||this.replHistory[this.replHistory.length-1]!==n.value)&&(this.replHistory.push(n.value),this.replHistory=this.replHistory.slice(-100),this.historyIndex=this.replHistory.length,localStorage.setItem("replHistory",JSON.stringify(this.replHistory))),l.value.push({type:"input",content:`
> ${n.value}
`}),this.wasmImports.runLine(this.ctx),setTimeout(function(){const i=document.querySelector("#stdout");i.scrollTop=i.scrollHeight},100),this.stdin=null}},historyUp(){this.replHistory.length!=0&&(this.historyIndex=Math.max(0,this.historyIndex-1),this.stdin=this.replHistory[this.historyIndex],this.setCursorAtEnd())},historyDown(){this.replHistory.length!=0&&(this.historyIndex=Math.min(this.historyIndex+1,this.replHistory.length),this.stdin=this.replHistory[this.historyIndex],this.setCursorAtEnd())},setCursorAtEnd(){const e=document.querySelector("#stdin");setTimeout(function(){e.selectionStart=e.selectionEnd=e.value.length},0)},clear(){l.value=[]},ansiToHtml(e){let t=[],n=null,i=null;for(const r of e.matchAll(/\033\[([0-9]+)m/g))n===null&&r.index>0?(n=0,t.push({content:e.slice(0,r.index)})):r.index>0&&(i.content=e.slice(n,r.index),t.push(i)),n=r.index+r[0].length,i={class:A[r[1]]};return n!==null&&n<e.length?i.textContent=e.slice(n):n===null&&t.push({content:e}),t}},async mounted(){const e=new TextDecoder,t=new TextEncoder;var n=new WebAssembly.Memory({initial:100,maximum:1e3});function i(d,s){let o=e.decode(new Uint8Array(n.buffer,d,s),{stream:!0});const c=l.value.length>0?l.value[l.value.length-1].type:null;c===null||c==="input"?l.value.push({type:"output",content:o}):l.value[l.value.length-1].content+=o}function r(d,s){const o=document.querySelector("#stdin");let c=o.value;return new Uint8Array(n.buffer,d,s).set(t.encode(c).slice(0,s)),o.value=null,Math.min(s,c.length)}this.wasmImports=(await WebAssembly.instantiateStreaming(fetch("buzz.wasm"),{env:{memory:n,writeToStderr:i,readFromStdin:r}})).instance.exports,this.ctx=this.wasmImports.initRepl(),document.querySelector("#stdin").focus(),this.replHistory=JSON.parse(localStorage.getItem("replHistory")??"[]").slice(-100),this.historyIndex=this.replHistory.length}});const E={class:"language-buzz"},D={id:"stdout"},M={class:"stdin-container"},N=a("span",{id:"prompt"},"Â»",-1),U={href:"https://github.com/buzz-language/buzz/issues",target:"_blank",rel:"noopener noreferrer"};function q(e,t,n,i,r,f){const d=x("ExternalLinkIcon");return u(),h("div",null,[a("div",E,[a("pre",D,[p("        "),(u(!0),h(y,null,g(e.stdout.value,s=>(u(),h(y,null,[(u(!0),h(y,null,g(e.ansiToHtml(s.content),o=>(u(),h(y,null,[o.content.length>0?(u(),h("code",{key:0,class:H(o.class??"")},I(o.content),3)):S("v-if",!0)],64))),256))],64))),256)),p(`
    `)]),a("div",M,[N,T(a("input",{onKeydown:[t[0]||(t[0]=m((...s)=>e.run&&e.run(...s),["enter"])),t[1]||(t[1]=m((...s)=>e.historyUp&&e.historyUp(...s),["up"])),t[2]||(t[2]=m((...s)=>e.historyDown&&e.historyDown(...s),["down"])),t[3]||(t[3]=m(z((...s)=>e.clear&&e.clear(...s),["ctrl"]),["l"]))],id:"stdin","onUpdate:modelValue":t[4]||(t[4]=s=>e.stdin=s),rows:"1",autocomplete:"off",placeholder:"Type buzz code here..."},null,544),[[k,e.stdin]])])]),a("p",null,[a("em",null,[p("Please "),a("a",U,[p("report"),_(d)]),p(" any bug or unexpected behaviour")])])])}const $=w(C,[["render",q],["__file","repl.html.vue"]]);export{$ as default};
