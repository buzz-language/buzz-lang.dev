import{d as y,_ as c,o as p,c as m,b as n,w as f,v as w,e as h,f as g,g as a}from"./app-8ee67877.js";const H=y({data:()=>({wasmImports:null,ctx:null,stdin:null,replHistory:[],historyIndex:0}),methods:{run(t){var e;if(!t.shiftKey&&((e=this.stdin)==null?void 0:e.length)>0){const o=document.querySelector(".stdout-container"),i=document.querySelector("#stdout"),r=document.querySelector("#stdin");(this.replHistory.length==0||this.replHistory[this.replHistory.length-1]!==r.value)&&(this.replHistory.push(r.value),this.replHistory=this.replHistory.slice(-100),this.historyIndex=this.replHistory.length,localStorage.setItem("replHistory",JSON.stringify(this.replHistory))),i.textContent+=`
> ${r.value}
`,this.wasmImports.runLine(this.ctx),o.scrollTop=o.scrollHeight}},historyUp(){this.replHistory.length!=0&&(this.historyIndex=Math.max(0,this.historyIndex-1),console.log(this.historyIndex),this.stdin=this.replHistory[this.historyIndex],this.setCursorAtEnd())},historyDown(){this.replHistory.length!=0&&(this.historyIndex=Math.min(this.historyIndex+1,this.replHistory.length),console.log(this.historyIndex),this.stdin=this.replHistory[this.historyIndex],this.setCursorAtEnd())},setCursorAtEnd(){const t=document.querySelector("#stdin");setTimeout(function(){t.selectionStart=t.selectionEnd=t.value.length},0)},clear(){document.querySelector("#stdout").textContent=""}},async mounted(){const t=new TextDecoder,e=new TextEncoder;var o=new WebAssembly.Memory({initial:100,maximum:1e3});function i(l,s){let d=t.decode(new Uint8Array(o.buffer,l,s),{stream:!0});const u=document.querySelector("#stdout");u.textContent+=d}function r(l,s){const d=document.querySelector("#stdin");let u=d.value;return new Uint8Array(o.buffer,l,s).set(e.encode(u).slice(0,s)),d.value=null,Math.min(s,u.length)}this.wasmImports=(await WebAssembly.instantiateStreaming(fetch("buzz.wasm"),{env:{memory:o,writeToStderr:i,readFromStdin:r}})).instance.exports,this.ctx=this.wasmImports.initRepl(),document.querySelector("#stdin").focus(),this.replHistory=JSON.parse(localStorage.getItem("replHistory")??"[]").slice(-100),this.historyIndex=this.replHistory.length}});const v={class:"language-buzz"},x=n("pre",{class:"stdout-container"},[a("        "),n("code",{id:"stdout"}),a(`
    `)],-1),I={class:"stdin-container"};function S(t,e,o,i,r,l){return p(),m("div",null,[n("div",v,[x,n("div",I,[f(n("input",{onKeydown:[e[0]||(e[0]=h((...s)=>t.run&&t.run(...s),["enter"])),e[1]||(e[1]=h((...s)=>t.historyUp&&t.historyUp(...s),["up"])),e[2]||(e[2]=h((...s)=>t.historyDown&&t.historyDown(...s),["down"])),e[3]||(e[3]=h(g((...s)=>t.clear&&t.clear(...s),["ctrl"]),["l"]))],id:"stdin","onUpdate:modelValue":e[4]||(e[4]=s=>t.stdin=s),rows:"1",placeholder:"Type buzz code here..."},null,544),[[w,t.stdin]])])])])}const T=c(H,[["render",S],["__file","repl.html.vue"]]);export{T as default};
